<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

	<bean id="plcValuesLoader" class="${plcValuesLoader}" />

	<bean id="plcPulseToMMConverterHandler" class="${plcPulseToMMConverterHandler}">
		<property name="encoderModFolEvalVarName" value=".stParameters.nEncoderModuleFoldEvaluation" />
		<property name="shapeDiameterVarName" value=".stParameters.nShapeDiameter" />
		<property name="encoderResolutionVarName" value=".stParameters.nEncoderResolution" />
	</bean>

	<bean id="mapPlcAdaptor" class="com.sicpa.standard.client.common.ioc.GenericMapping" scope="prototype">
		<constructor-arg>
			<map>
				<entry key="standard" value-ref="plcAdaptor" />
				<entry key="simulator" value-ref="plcSimulatorAdaptor" />
			</map>
		</constructor-arg>
	</bean>

	<bean id="plc" factory-bean="mapPlcAdaptor" factory-method="get" scope="prototype">
		<constructor-arg value="${plc.behavior}" />
	</bean>

	<!-- Standard PLC - Create model for standard PLC controller -->
	<bean id="stdPlcModel" class="com.sicpa.standard.client.common.utils.ConfigUtils" factory-method="load">
		<constructor-arg value="config/plc/plc.xml" />
		<property name="parameters">
			<map />
		</property>
		<property name="lifeCheckRequest" ref="lifeCheckVar" />
	</bean>

	<!-- StandardPLC - Create standard PLC controller -->
	<bean id="stdPlcController" class="${stdPlcController}" scope="prototype">
		<property name="model" ref="stdPlcModel" />
	</bean>


	<!-- Simulator - Create model for PLC simulator -->
	<bean id="plcSimulatorModel" class="com.sicpa.standard.client.common.utils.ConfigUtils" factory-method="load">
		<constructor-arg value="config/plc/simulator/plcSimulator.xml" />
	</bean>


	<!-- Simulator - create PLC simulator controller -->
	<bean id="plcSimulatorController" class="${plcSimulatorController}" scope="prototype">
		<constructor-arg ref="plcSimulatorModel" />
		<property name="simulatorGui" ref="simulatorGui" />
	</bean>

	<bean id="plcAdaptor" class="com.sicpa.tt018.scl.devices.plc.impl.AlbaniaPLC" scope="prototype">
		<constructor-arg ref="stdPlcController" />
		<property name="notificationVariables" ref="plcCabinetNtf" />
		<property name="plcRequestActionMap" ref="mapPlcRequestAction" />
		<property name="parameters" ref="plcCabinetParameters" />
		<property name="loader" ref="plcValuesLoader" />
		<property name="parameterLine" ref="plcLineParamsTemplate" />
		<property name="notificationLine" ref="plcConveyorNtfTemplate" />
		<property name="lineVarGroups" ref="lineVarGroups" />
		<property name="sensorTypeVariable" ref="sensorTypeParam" />
		<property name="configFileHolder" ref="albaniaConfigFilePlcHolder" />
		<property name="productionParameters" ref="productionParameters" />
	</bean>

	<bean id="albaniaConfigFilePlcHolder" class="com.sicpa.tt018.scl.devices.plc.impl.AlbaniaConfigFilePlcHolder">
		<property name="configFileByProductTypeMapping">
			<map>
				<entry key="1" value="bottleConfig.xml" />
				<entry key="2" value="canConfig.xml" />
				<entry key="3" value="otherConfig.xml" />
			</map>
		</property>
	</bean>

	<!-- this variable descriptor will have to be injected in variable group in the View.xml to become editable -->
	<bean id="sensorTypePlcVarDesc" class="com.sicpa.standard.sasscl.devices.plc.variable.descriptor.PlcShortVariableDescriptor">
		<property name="variable" ref="sensorTypeParam" />
		<property name="min" value="0" />
		<property name="max" value="30000" />
		<property name="plcProvider" ref="plcProvider" />
	</bean>

	<bean id="sensorTypeParam" class="com.sicpa.standard.plc.value.PlcVariable" factory-method="createShortVar">
		<constructor-arg value=".com.stLine[1].stParameters.nPackageType" />
	</bean>

	<bean id="plcSimulatorAdaptor" class="com.sicpa.tt018.scl.devices.plc.impl.AlbaniaPLCSimulator" scope="prototype">
		<constructor-arg ref="plcSimulatorController" />
		<property name="notificationVariables" ref="plcCabinetNtf" />
		<property name="plcRequestActionMap" ref="mapPlcRequestAction" />
		<property name="parameters" ref="plcCabinetParameters" />
		<property name="loader" ref="plcValuesLoader" />
		<property name="parameterLine" ref="plcLineParamsTemplate" />
		<property name="notificationLine" ref="plcConveyorNtfTemplate" />
		<property name="lineVarGroups" ref="lineVarGroups" />
		<property name="sensorTypeVariable" ref="sensorTypeParam" />
		<property name="configFileHolder" ref="albaniaConfigFilePlcHolder" />
	</bean>

	<bean id="plcRemoteServerConnectionHandler" class="${plcRemoteServerConnectionHandler}">
		<property name="remoteServer" ref="remoteServer" />
		<property name="plcProvider" ref="plcProvider" />
	</bean>

	<bean id="plcStateListener" class="${plcStateListener}">
		<property name="plcProvider" ref="plcProvider" />
	</bean>

	<bean id="plcRegisterHandler" class="${plcRegisterHandler}">
		<property name="plcProvider" ref="plcProvider" />
	</bean>

</beans>
