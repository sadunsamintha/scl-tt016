<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">


	<bean id="flowControl" class="${flowControl}" init-method="initMachine">
		<property name="stateMachine" ref="stateMachine" />
		<property name="flowControlWiring" ref="flowControlWiring" />
	</bean>

	<bean id="stateMachine" class="${stateMachine}">
		<constructor-arg value="#{flowControlWiring.getInitialState()}" />
	</bean>

	<bean id="flowControlWiring" class="${flowControlWiring}">
		<property name="executorExit" ref="executorExit" />
		<property name="executorStarted" ref="executorStarted" />
		<property name="executorStarting" ref="executorStarting" />
		<property name="executorNoSelection" ref="executorNoSelection" />
		<property name="executorConnecting" ref="executorConnecting" />
		<property name="executorSelectWithPrevious" ref="executorSelectWithPrevious" />
		<property name="executorConnected" ref="executorConnected" />
		<property name="executorSelectNoPrevious" ref="executorSelectNoPrevious" />
		<property name="executorStopping" ref="executorStopping" />
		<property name="executorRecovering" ref="executorRecovering" />
		<property name="executorDisconnectingOnParamChanged" ref="executorDisconnectingOnParamChanged" />
	</bean>

	<bean id="executorRecovering" class="${executorRecovering}" />

	<bean id="executorExit" class="${executorExit}">
		<property name="hardwareController" ref="hardwareController" />
		<property name="production" ref="production" />
		<property name="storage" ref="storage" />
		<property name="statistics" ref="statistics" />
		<property name="screensFlow" ref="screensFlow" />
	</bean>

	<bean id="executorStarted" class="${executorStarted}" />

	<bean id="executorStarting" class="${executorStarting}">
		<property name="statistics" ref="statistics" />
		<property name="alert" ref="alert" />
		<property name="productionBatchProvider" ref="productionBatchProvider" />
		<property name="hardwareController" ref="hardwareController" />
		<property name="startValidators">
			<list>
				<ref bean="maxRemoteServerDownTimeListener" />
				<ref bean="parametersAvailableStartValidator" />
			</list>
		</property>
	</bean>
	<bean id="executorNoSelection" class="${executorNoSelection}" />
	<bean id="executorConnecting" class="${executorConnecting}">
		<property name="hardwareController" ref="hardwareController" />
		<property name="productionParameters" ref="productionParameters" />
		<property name="productionInitiator" ref="productionInitiator" />
		<property name="loader" ref="productionConfigLoader" />
		<property name="productionConfigProvider" ref="productionConfigProvider" />
		<property name="statistics" ref="statistics" />
	</bean>
	<bean id="executorSelectWithPrevious" class="${executorSelectWithPrevious}">
		<property name="screensFlow" ref="screensFlow" />
	</bean>
	<bean id="executorConnected" class="${executorConnected}" />
	<bean id="executorSelectNoPrevious" class="${executorSelectNoPrevious}">
		<property name="screensFlow" ref="screensFlow" />
	</bean>
	<bean id="executorStopping" class="${executorStopping}">
		<property name="hardwareController" ref="hardwareController" />
		<property name="alert" ref="alert" />
	</bean>
	<bean id="executorDisconnectingOnParamChanged" class="${executorDisconnectingOnParamChanged}">
		<property name="hardwareController" ref="hardwareController" />
	</bean>


	<bean id="hardwareControllerStatusListener" class="${hardwareControllerStatusListener}">
		<property name="flowControl" ref="flowControl" />
	</bean>

	<bean id="productionParameterChangedListener" class="${productionParameterChangedListener}">
		<property name="storage" ref="storage" />
		<property name="flowControl" ref="flowControl" />
	</bean>

	<!-- OLD -->

	<!-- MESSAGES -->
	<bean id="messagesHandler" class="${messagesHandler}">
		<property name="messagesMapping" ref="messagesMapping"/>
	</bean>
	
	<bean id="warningHandler" class="${warningHandler}" />
	<bean id="errorHandler" class="${errorHandler}">
		<property name="flowControl" ref="flowControl" />
	</bean>
	<bean id="errorDisplayHandler" class="${errorDisplayHandler}" />


	<!-- production parameters START VALIDATORS -->

	<bean id="parametersAvailableStartValidator" class="${parametersAvailableStartValidator}">
		<property name="productionParameters" ref="productionParameters" />
		<property name="skuListProvider" ref="skuListProvider" />
	</bean>

	<!-- max downtine listener -->
	<bean id="maxRemoteServerDownTimeListener" class="${maxRemoteServerDownTimeListener}" />

</beans>
