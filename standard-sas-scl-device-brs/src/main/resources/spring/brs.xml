<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:aop="http://www.springframework.org/schema/aop" xmlns:util="http://www.springframework.org/schema/util"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

	<bean id="brsSkuCheck" class="${brsSkuCheck}">
		<property name="nonCompliantProductResolver" ref="nonCompliantProduct" />
	</bean>

	<bean id="mapBrsAdaptor" class="com.sicpa.standard.client.common.ioc.GenericMapping" scope="prototype">
		<constructor-arg>
			<map>
				<entry key="standard" value-ref="brsAdaptorStd" />
				<entry key="simulator" value-ref="brsAdaptorSimulator" />
			</map>
		</constructor-arg>
	</bean>

	<bean id="brsAdaptor" factory-bean="mapBrsAdaptor" factory-method="get" scope="prototype"  >
		<constructor-arg value="${brs.behavior}" />
	</bean>

	<bean id="brsAdaptorStd" class="${brsAdaptor}" scope="prototype" init-method="createReaders">
		<constructor-arg ref="stdBrsModel" />

		<property name="brsLifeCheckInterval" value="${brs.lifecheck.interval}" />
		<property name="brsLifeCheckTimeout" value="${brs.lifecheck.timeout}" />
		<property name="brsLifeCheckNumberOfRetries" value="${brs.lifecheck.retries}" />

	</bean>

	<bean id="stdBrsModel"  class="com.sicpa.standard.client.common.utils.ConfigUtils" factory-method="load" >
		<constructor-arg value="config/brs/brsConfig.xml" />
	</bean>

	<!--simulator beans-->

	<bean id="brsAdaptorSimulator" class="${brsAdaptorSimulator}" scope="prototype">
		<constructor-arg ref="simulatorBrsModel" />
		<constructor-arg ref="productionParameters" />
		<constructor-arg value="${brs.behavior}" />
	</bean>


	<bean id="simulatorBrsModel" class="com.sicpa.standard.client.common.utils.ConfigUtils" factory-method="load" >
		<constructor-arg value="config/brs/simulator/brsSimulator.xml" />
	</bean>

	<!--alert tasks-->

	<bean id="alertBrsProductWarningCount" class="${alertBrsProductWarningCount}">
		<property name="unreadBarcodesWarningThreshold" value="${alert.unreadbarcodes.warning.threshold}" />
		<property name="isUnreadBarcodesEnable" value="${alert.unreadbarcodes.enable}" />
		<property name="productionConfigProvider" ref="productionConfigProvider" />
		<property name="nonCompliantProductResolver" ref="nonCompliantProduct" />

	</bean>

	<bean id="alertBrsProductErrorCount" class="${alertBrsProductErrorCount}">
		<property name="unreadBarcodesErrorThreshold" value="${alert.unreadbarcodes.error.threshold}" />
		<property name="isUnreadBarcodesEnable" value="${alert.unreadbarcodes.enable}" />
		<property name="productionConfigProvider" ref="productionConfigProvider" />
		<property name="nonCompliantProductResolver" ref="nonCompliantProduct" />

	</bean>

	<bean id="alertBrsProducWarningCountAddTask" class="com.sicpa.standard.client.common.ioc.InjectByMethodBean">
		<property name="target" ref="alert" />
		<property name="methodName" value="addTask" />
		<property name="params" ref="alertBrsProductWarningCount" />
	</bean>

	<bean id="alertBrsProducErrorCountAddTask" class="com.sicpa.standard.client.common.ioc.InjectByMethodBean">
		<property name="target" ref="alert" />
		<property name="methodName" value="addTask" />
		<property name="params" ref="alertBrsProductErrorCount" />
	</bean>

	<!--non compliant product resolver -->

	<bean id="nonCompliantProduct" class="${nonCompliantProduct}" />

</beans>